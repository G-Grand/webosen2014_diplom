<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>EasyRide</title>

    <!-- Bootstrap -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script type="text/javascript" src="js/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="http://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>

    <script type="text/javascript">
//        $('document').ready(function (){
//            // Date-field
//            $('.datetimepicker').each(function() {
//              $(this).datetimepicker({
//                language: 'ru'
//              });
//            });
//        });
    </script>

    <script type="text/javascript">
        var myMap;
   function init() {
        myMap = new ymaps.Map('map', {
            center: [60.906882, 30.067233],
            zoom: 9,
            type: 'yandex#map',
            controls: []
        });

}


ymaps.ready(init);

    </script>

      <style>
          .droplist {

          }
          .list {
              display: none;
              position: absolute;
              background-color: #F3F3F3;
              border: 1px solid #aaa;
              z-index: 999;
              top: 33px;
              width: 100%;
          }
          .list option:hover {
              background: #33aaff;
              cursor: pointer;
          }
      </style>

<script>
    var startCoords,finishCoords;
    $('document').ready(function (){
        var findCoorsds = {};

        $("#InputStart").on("keypress", function(){
            var start = this;
            clearTimeout(findCoorsds["startPoint"]);
            findCoorsds["startPoint"] = setTimeout(function(){
                console.log(start);
                var url = "https://geocode-maps.yandex.ru/1.x/?format=json&geocode="+start.value;
                $.ajax({
                    url: url,
                    type: "GET",
                    dataType: "json",
                    success: function (resp) {
                        console.log(resp);
                        var datalist = document.getElementById("start_list");
                        var geoList = resp.response.GeoObjectCollection.featureMember;
                        var list = "";
                        for(var i=0; i<geoList.length; ++i) {
                            var obj = geoList[i].GeoObject;
                            var value = obj.Point.pos;
                            var text = obj.metaDataProperty.GeocoderMetaData.text;
                            list += "<option value='"+value+"'>"+text+"</option>";
                        }
                        datalist.innerHTML = list;
                        datalist.style.display = "block";
                        $(datalist).find("option").each(function() {
                            $(this).on("click", function() {
                                start.value = $(this).text();
                                startCoords = $(this).text();
                                datalist.style.display = "none";
                            });
                        });
                    }
                })
            }, 1000);
        });

        $("#InputFinish").on("keypress", function(){
            var start = this;
            clearTimeout(findCoorsds["finishPoint"]);
            findCoorsds["finishPoint"] = setTimeout(function(){
                console.log(start);
                var url = "https://geocode-maps.yandex.ru/1.x/?format=json&geocode="+start.value;
                $.ajax({
                    url: url,
                    type: "GET",
                    dataType: "json",
                    success: function (resp) {
                        console.log(resp);
                        var datalist = document.getElementById("finish_list");
                        var geoList = resp.response.GeoObjectCollection.featureMember;
                        console.log(resp.response);
                        console.log(resp.response.GeoObjectCollection);
                        console.log(resp.response.GeoObjectCollection.featureMember);
                        console.log(geoList);
                        var list = "";
                        for(var i=0; i<geoList.length; ++i) {
                            var obj = geoList[i].GeoObject;
                            var value = obj.Point.pos;
                            var text = obj.metaDataProperty.GeocoderMetaData.text;
                            list += "<option value='"+value+"'>"+text+"</option>";
                        }
                        datalist.innerHTML = list;
                        datalist.style.display = "block";
                        $(datalist).find("option").each(function() {
                            $(this).on("click", function() {
                                start.value = $(this).text();
                                finishCoords = $(this).text();
                                datalist.style.display = "none";
                            });
                        });
                    }
                })
            }, 1000);
        });

        $("#setCoords").on("click", function() {
            if(!startCoords && !finishCoords) {return false;}

//            startCoords = startCoords.split(" ");
//            finishCoords = finishCoords.split(" ");
            console.log(startCoords);
            console.log(finishCoords);


            ymaps.route([
//                [parseFloat(startCoords[0]),parseFloat(startCoords[1])],
//                [parseFloat(finishCoords[0]),parseFloat(finishCoords[1])]
                    startCoords,finishCoords
            ])
                 .then(
                    function (route) {
                        myMap.geoObjects.add(route);
                    },
                    function (error) {
                        alert("Возникла ошибка: " + error.message);
                    }
                 );

        });

    });

</script>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
        
            <div class="content">
           
            <div class="row">
            <div class="col-sm-6"><h1>Создать маршрут</h1></div>

            <!-- Шаг 1 -->
            <div class="panel-group col-sm-8" id="accordion" role="tablist" aria-multiselectable="true">
                <div class="panel panel-default">
                  <div class="panel-heading" role="tab" id="headingOne">
                    <h4 class="panel-title">Шаг #1</h4>
                  </div>
                  <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                    <div class="panel-body">
                      <form method="POST" role="form" name="formPlaces">
                        <div class="form-group">
                            <label for="InputStart">Отправление</label>
                            <div class="input-group">
                              <span class="input-group-addon"><i class="glyphicon glyphicon-map-marker"></i></span>                            
                              <div class="droplist">
                                  <input id="InputStart" type="text" class="form-control" placeholder="Ваш пункт отправления">
                                  <div id="start_list" class="list"></div>
                              </div>
                            </div>
                        </div>
                        <div class="form-group">
                          <label for="InputFinish">Прибытие</label>
                          <div class="input-group">
                              <span class="input-group-addon"><i class="glyphicon glyphicon-map-marker"></i></span>
                              <div class="droplist">
                                <input type="text" class="form-control" id="InputFinish" placeholder="Ваш пункт прибытия" value="">
                                <div id="finish_list" class="list"></div>
                              </div>
                          </div>
                        </div>
                      
                        <div class="form-group">
                            <label for="inputAuto" class="control-label col-md-4">Выбирите ТС на котором<br> планируете поездку</label>
                            <div class="col-md-8">
                                <select class="form-control" id="inputAuto">
                                  <option>Opel</option>
                                  <option>Nissan</option>
                                  <option>Ваз</option>
                                </select>
                            </div>
                        </div>
                        </form>
                        <div class="col-md-12 text-right">
                            <a id="setCoords" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                            Далее</a>
                        </div>
                    </div>

                  </div>
                </div>

                <!-- Шаг 2 -->
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingTwo">
                      <h4 class="panel-title"> Шаг #2  </h4>
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                        <div class="panel-body">
                          <form role="form" name="formWaypoints">
                            <div class="form-group">
                              <label for="WayPoints">Добавьте промежуточные пункты, которые вы будете проезжать. Это очень важно для поиска пассажиров.</label>
                              <textarea style="resize:none" class="form-control" rows="1" id="WayPoints" placeholder="Промежуточные пункты" value=""></textarea>
                            </div>
                          </form>

                            <!-- Доп инфа раскрывающаяся -->
                              <div class="panel-group" id="accordion2" role="tablist" aria-multiselectable="true">
                                <div class="panel panel-default">
                                  <div class="panel-heading" role="tab" id="headingDop">
                                    <h4 class="panel-title">
                                      <a data-toggle="collapse" data-parent="#accordion2" href="#collapseDop" aria-expanded="false" aria-controls="collapseDop">
                                              Дополнительная информация
                                      </a>
                                    </h4>
                                  </div>
                                  <div id="collapseDop" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingDop">
                                    <div class="panel-body">
                                        <form method="POST" role="form" name="formDopinfo">
                                          <div class="form-group" >
                                               <textarea  style="resize:none" type="text" class="form-control" rows="4" placeholder="Добавьте деталей к описанию вашей поездки - это поможет избежать многочисленных вопросов от пассажиров. Например: место встречи, музыку, которую слушаете, какую-либо полезную информацию для пассажиров." value=""></textarea>
                                         </div>
                                        </form>
                                              <h5><span class="glyphicon glyphicon-exclamation-sign"></span> Ваши контактные данные (номер мобильного и эл. адрес)
                                              уже есть в вашем профиле. Пожалуйсто, не добавляйте их здесь!</h5>
                                        
                                    </div>
                                  </div>
                                </div>
                              </div>
                            
                                           
                                <div class="col-md-12 text-right">                        
                                    <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                                      Шаг#1 
                                    </a>
                                    <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                      Далее
                                    </a>
                                </div>
                            
                        </div>
                    </div>
                </div>
                    
                 
                 <!-- Шаг 3 дата и время -->
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingThree">
                        <h4 class="panel-title"> Шаг #3 </h4>
                    </div>
                    <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                    
                    <div class="panel-body">
                    <form method="POST" role="form" name="formDate">
                        <div class="form-group col-md-4">
                            <!-- Data_picker -->
                            <label for="DateDep">Дата отправления:</label>
                            <div class="input-group">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span> 
                                <input class="form-control datetimepicker" id="DateDep" type="text" placeholder="дд-мм-гггг" value="">
                            </div>
                        </div>
                      
                        <div class="form-group col-md-4">
                            <!-- Data_picker -->
                            <label for="DateArrival">Дата прибытия:</label>
                            <div class="input-group">
                                 <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span> 
                                <input class="form-control datetimepicker" id="DateArrival" type="text" placeholder="дд-мм-гггг" value="">
                            </div>
                        </div>
                    </form>
                  
                    <div class="col-md-12 text-right">                       
                        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                              Шаг#2</a>
                        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapse4" aria-expanded="false" aria-controls="collapse4">
                              Далее</a>
                    </div>
               
                    </div>
                    </div>
                </div>

                <!-- Шаг 4 стоимость -->
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="heading4">
                        <h4 class="panel-title">Шаг #4 </h4>
                    </div>
                    <div id="collapse4" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading4">
                        <div class="panel-body">
                            <form method="POST" role="form" name="formPlaces">
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                    <label for="price" class="col-md-3 text-danger">Цена с пассажира:</label>
                                    <div class="input-group col-md-4">    
                                      <input type="text" class="form-control" id="price" placeholder="100" value="">
                                      <span class="input-group-addon"><i>грн.</i></span> 
                                    </div>
                                </div>
                              </div>
                              <div class="col-md-6">                                
                                <div class="form-group">
                                    <label for="seats" class="col-md-3 text-danger">Свободных мест:</label>
                                    <div class="input-group col-md-3">    
                                      <input type="text" class="form-control" id="seats" placeholder="5" value="">
                                    </div>
                                </div>
                              </div>
                            </div>
                            </form>
                            <div class="col-md-12 text-right">                       
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Шаг#3</a>
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseMap" aria-expanded="false" aria-controls="collapseMap">
                              Далее</a>
                            </div>
                        </div>
                    </div>
                </div>
                

                <!-- Шаг 5 Карта-->
                <div class="panel panel-default">
                  <div class="panel-heading" role="tab" id="headingMap">
                    <h4 class="panel-title">Маршрут </h4>
                  </div>
                  <div id="collapseMap" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingMap">

                    <div class="row-fluid">
                        
                            
                        <div id="map" style="width: 100%; height: 400px"></div>
                      </div>

                    <div class="panel-body">
                      <div>
                        <h4>Днепрoпетровск &#8594; Днепродзержинск <span class="glyphicon glyphicon-road"></span></h4>
                      </div>
                      <div class="col-md-3">Отправление:</div><div> 07/07/2015 в 8:00</div>
                      <div class="col-md-3">Стоимость:</div><div> 20 грн.</div>
                     
                    <button type="button" class="btn btn-warning btn-lg pull-right">Создать</button>
                    </div>
                  </div>
                  </div>
                </div>
 
        </div> 
        </div>
        </div>   
  </body>
</html>

